<html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../expandjs/expandjs.html">
<link rel="import" href="../xp-emitter/xp-emitter.html">

<script src="dist/xp-request.min.js"></script>

<script>Polymer({is:"xp-request",abort:function(){var e=this;return e.request&&e.request.abort(),e},header:function(e,t){XP.assertArgument(XP.isString(e,!0),1,"string"),XP.assertArgument(XP.isVoid(t)||XP.isFalse(t)||XP.isInput(t,!0),2,"string");var r=this;return XP.isDefined(t)?t?r.headers[e]=t:void delete r.headers[e]:r.headers[e]},reset:function(){var e=this;return e._setCurrent(null),e},submit:function(e,t){XP.isFunction(e)&&(t=e,e=null);var r=this;return r.fire("xp-request-submit",{firer:r,data:e},{cancelable:!0}).defaultPrevented?null:r.hostname||r.path||r.port||r.url?(r._setRequest(new XPRequest({contentType:r.contentType,encoding:r.encoding,headers:r.headers,hostname:r.hostname,keepAlive:r.keepAlive,method:r.method,path:r.path,port:r.port,protocol:r.protocol,responseType:r.responseType,url:r.url})),r.request.on("chunk",r._handleChunk),r.request.on("data",r._handleData),r.request.on("error",r._handleError),r.request.on("response",r._handleResponse),r.request.on("state",r._handleState),r.request.submit(e,t)):r._setRequest(null)},observers:["_urlChanged(contentType, headers.*, hostname, method, path, port, protocol, responseType, url)"],properties:{auto:{type:Boolean,value:!1},chunks:{notify:!0,readOnly:!0,type:Array,value:function(){return[]}},contentType:{type:String,value:null},current:{notify:!0,observer:"_currentChanged",readOnly:!0},data:{notify:!0,readOnly:!0},empty:{computed:"_computeEmpty(data)",notify:!0,reflectToAttribute:!0,type:Boolean,value:!0},encoding:{type:String,value:"utf-8"},error:{notify:!0,readOnly:!0,type:String},headers:{notify:!0,type:Object,value:function(){return{}}},hostname:{type:String,value:null},keepAlive:{type:Number,value:0},method:{type:String,value:"GET"},path:{type:String,value:null},port:{type:Number,value:null},protocol:{type:String,value:null},request:{notify:!0,readOnly:!0},responseType:{type:String,value:null},state:{notify:!0,readOnly:!0,reflectToAttribute:!0,type:String,value:"idle"},statusCode:{notify:!0,readOnly:!0,type:Number},statusMessage:{notify:!0,readOnly:!0,type:String},url:{type:String,value:null},wait:{type:Number}},_computeEmpty:function(e){return!e},_currentChanged:function(){var e=this;e._setChunks([]),e._setData(null),e._setError(e.current&&e.current.error||null),e._setStatusCode(e.current&&e.current.statusCode||null),e._setStatusMessage(e.current&&e.current.statusMessage||null)},_urlChanged:function(){var e=this;e.reset(),e.auto&&e.debounce("submit",e.submit.bind(e),e.wait)},created:function(){var e=this;e._handleChunk=e._handleChunk.bind(e),e._handleData=e._handleData.bind(e),e._handleError=e._handleError.bind(e),e._handleResponse=e._handleResponse.bind(e),e._handleState=e._handleState.bind(e),e.classList.add("request")},_handleChunk:function(e,t){var r=this;t===r.current&&(r.push("chunks",e),r.fire("xp-request-chunk",{firer:r,chunk:e}))},_handleData:function(e,t){var r=this;t===r.current&&(r._setData(e),r.fire("xp-request-data",{firer:r,data:e}))},_handleError:function(e,t){var r=this;r.current&&t.tsSubmit<r.current.tsSubmit||(r._setCurrent(t),r._setError(e),r.fire("xp-request-error",{firer:r,error:e}))},_handleResponse:function(e,t){var r=this;r.current&&t.tsSubmit<r.current.tsSubmit||(r._setCurrent(t),r.fire("xp-request-response",{firer:r,statusCode:r.statusCode,statusMessage:r.statusMessage,url:r.url}))},_handleState:function(e,t){var r=this;t===r.request&&(r._setState(e),r.fire("xp-request-state",{firer:r,state:e}))}});</script>
</head><body></body></html>