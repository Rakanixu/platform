<script>
  'use strict';

  (function() {
    var customHeaders;
    var userId;

    // window.Endpoints are defined on the electron index.js file (The one which is loaded in browser)
    Polymer.EndpointsBehaviorImp = {
      properties: {
        endpoints: {
          type: Object,
          notify: true,
          value: function() {
            return window.Endpoints
          }
        },
        headers: {
          type: Object,
          notify: true,
          value: function() {
            return this.getHeaders();
          }
        }
      },
      getHeaders: function() {
        return customHeaders;
      },
      getPublicHeaders: function() {
        return {
          Token: 'ajsdIgsnaloHFGis823jsdgyjTGDKijfcjk783JDUYFJyggvwejkxsnmbkjwpoj6483'
        }
      },
      setHeaders: function(headers) {
        customHeaders = headers;
      },
      getToken: function() {
        return JSON.parse(localStorage.getItem('token')).access_token;
      },
      checkUnauthorize: function() {
        // Unauthorize
        if (event.detail.request.xhr.response.code === 401) {
          localStorage.clear();
          this._loadPage(1, 'login-activated', {});
        }
      },
      getUserId: function() {
        return userId;
      },
      setUserId: function(id) {
        userId = id;
      }
    };
  }());
</script>
