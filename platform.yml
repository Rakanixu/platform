version: '2'
services:
  audio-srv:
    command: go run src/github.com/kazoup/platform/audio/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  auth-web:
    command: go run src/github.com/kazoup/platform/auth/web/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  config-web:
    command: go run src/github.com/kazoup/platform/config/web/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  crawler-srv:
    command: go run src/github.com/kazoup/platform/crawler/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  datasource-srv:
    command: go run src/github.com/kazoup/platform/datasource/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  db-srv:
    command: go run src/github.com/kazoup/platform/db/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - elasticsearch
    - redis
    expose:
      - "9090"
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"

  document-srv:
    command: go run src/github.com/kazoup/platform/document/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - tika
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  file-srv:
    command: go run src/github.com/kazoup/platform/file/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  image-srv:
    command: go run src/github.com/kazoup/platform/image/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  media-web:
    command: go run src/github.com/kazoup/platform/media/web/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  monitor-srv:
    command: go run src/github.com/kazoup/platform/monitor/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  monitor-web:
    command: go run src/github.com/kazoup/platform/monitor/web/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  notification-srv:
    command: go run src/github.com/kazoup/platform/notification/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  notification-web:
    command: go run src/github.com/kazoup/platform/notification/web/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  profile-srv:
    command: go run src/github.com/kazoup/platform/profile/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  quota-srv:
    command: go run src/github.com/kazoup/platform/quota/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  search-srv:
    command: go run src/github.com/kazoup/platform/search/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  sentimentanalyzer-srv:
    command: go run src/github.com/kazoup/platform/sentimentanalyzer/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  textanalyzer-srv:
    command: go run src/github.com/kazoup/platform/textanalyzer/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

  thumbnail-srv:
    command: go run src/github.com/kazoup/platform/thumbnail/srv/main.go --registry_address=registry:8500 --broker=nats --broker_address=nats:4222 --server_address=0.0.0.0:9090 --transport=tcp
    image: golang:1.7-alpine3.5
    external_links:
    - registry
    - nats
    - redis
    expose:
      - "9090"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/srv/google-app-credentials/google-cloud-service-account.json
    volumes:
      - "./cmd/kazoup/ssl:/ssl"
      - "../../../:/go/src/"
      - "./cmd/kazoup/google-app-credentials:/srv/google-app-credentials"

networks:
  default:
    external:
      name: kazoup-platform
