var exports=exports||this;exports.OAuth=function(e){function t(e){var t,r=arguments,n=r.callee,o=(r.length,this);if(!(this instanceof n))return new n(e);for(t in e)e.hasOwnProperty(t)&&(o[t]=e[t]);return o}function r(){}function n(e){var t,r,n,s,i,a,u,c=arguments,h=c.callee,f=/^([^:\/?#]+?:\/\/)*([^\/:?#]*)?(:[^\/?#]*)*([^?#]*)(\?[^#]*)?(#(.*))*/,l=this;return this instanceof h?(l.scheme="",l.host="",l.port="",l.path="",l.query=new o,l.anchor="",void(null!==e&&(t=e.match(f),r=t[1],n=t[2],s=t[3],i=t[4],a=t[5],u=t[6],r=void 0!==r?r.replace("://","").toLowerCase():"http",s=s?s.replace(":",""):"https"===r?"443":"80",r="http"==r&&"443"===s?"https":r,a=a?a.replace("?",""):"",u=u?u.replace("#",""):"",("https"===r&&"443"!==s||"http"===r&&"80"!==s)&&(n=n+":"+s),l.scheme=r,l.host=n,l.port=s,l.path=i||"/",l.query.setQueryParams(a),l.anchor=u||""))):new h(e)}function o(e){var t,r=arguments,n=r.callee,o=(r.length,this);if(s.urlDecode,!(this instanceof n))return new n(e);if(void 0!=e)for(t in e)e.hasOwnProperty(t)&&(o[t]=e[t]);return o}function s(e){return this instanceof s?this.init(e):new s(e)}function i(e){var t,r,n=[];for(t in e)e[t]&&void 0!==e[t]&&""!==e[t]&&("realm"===t?r=t+'="'+e[t]+'"':n.push(t+'="'+s.urlEncode(e[t]+"")+'"'));return n.sort(),r&&n.unshift(r),n.join(", ")}function a(e,t,r,n){var o,i=[],a=s.urlEncode;for(o in r)void 0!==r[o]&&""!==r[o]&&i.push([s.urlEncode(o),s.urlEncode(r[o]+"")]);for(o in n)void 0!==n[o]&&""!==n[o]&&(r[o]||i.push([a(o),a(n[o]+"")]));return i=i.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:e[1]<t[1]?-1:e[1]>t[1]?1:0}).map(function(e){return e.join("=")}),[e,a(t),a(i.join("&"))].join("&")}function u(){return parseInt(+new Date/1e3,10)}function c(e){function t(){return Math.floor(Math.random()*a.length)}e=e||64;var r,n=e/8,o="",s=n/4,i=n%4,a=["20","21","22","23","24","25","26","27","28","29","2A","2B","2C","2D","2E","2F","30","31","32","33","34","35","36","37","38","39","3A","3B","3C","3D","3E","3F","40","41","42","43","44","45","46","47","48","49","4A","4B","4C","4D","4E","4F","50","51","52","53","54","55","56","57","58","59","5A","5B","5C","5D","5E","5F","60","61","62","63","64","65","66","67","68","69","6A","6B","6C","6D","6E","6F","70","71","72","73","74","75","76","77","78","79","7A","7B","7C","7D","7E"];for(r=0;s>r;r++)o+=a[t()]+a[t()]+a[t()]+a[t()];for(r=0;i>r;r++)o+=a[t()];return o}function h(){var t;if("undefined"!=typeof e.Titanium&&"undefined"!=typeof e.Titanium.Network.createHTTPClient)t=e.Titanium.Network.createHTTPClient();else if("undefined"!=typeof require)try{t=new require("xhr").XMLHttpRequest()}catch(r){if("undefined"==typeof e.XMLHttpRequest)throw"No valid request transport found.";t=new e.XMLHttpRequest}else{if("undefined"==typeof e.XMLHttpRequest)throw"No valid request transport found.";t=new e.XMLHttpRequest}return t}function f(e){var t=new Array(++e);return t.join(0).split("")}function l(e){var t,r,n=[];for(r=0;r<e.length;r++)t=e.charCodeAt(r),128>t?n.push(t):2048>t?n.push(192+(t>>6),128+(63&t)):65536>t?n.push(224+(t>>12),128+(63&t>>6),128+(63&t)):2097152>t&&n.push(240+(t>>18),128+(63&t>>12),128+(63&t>>6),128+(63&t));return n}function p(e){var t,r=[];for(t=0;t<32*e.length;t+=8)r.push(255&e[t>>>5]>>>24-t%32);return r}function d(e){var t,r=[],n=e.length;for(t=0;n>t;t++)r.push((e[t]>>>4).toString(16)),r.push((15&e[t]).toString(16));return r.join("")}function v(e){var t,r="",n=e.length;for(t=0;n>t;t++)r+=String.fromCharCode(e[t]);return r}function y(e,t){return e<<t|e>>>32-t}function g(e){if(void 0!==e){var t,r,n=e;return n.constructor===String&&(n=l(n)),t=this instanceof g?this:new g(e),r=t.hash(n),d(r)}return this instanceof g?this:new g}function k(e,t,r,n){var o,s,i,a,u=l(t),c=l(r),h=u.length;for(h>e.blocksize&&(u=e.hash(u),h=u.length),u=u.concat(f(e.blocksize-h)),s=u.slice(0),i=u.slice(0),a=0;a<e.blocksize;a++)s[a]^=92,i[a]^=54;return o=e.hash(s.concat(e.hash(i.concat(c)))),n?d(o):v(o)}r.prototype={join:function(e){return e=e||"",this.values().join(e)},keys:function(){var e,t=[],r=this;for(e in r)r.hasOwnProperty(e)&&t.push(e);return t},values:function(){var e,t=[],r=this;for(e in r)r.hasOwnProperty(e)&&t.push(r[e]);return t},shift:function(){throw"not implimented"},unshift:function(){throw"not implimented"},push:function(){throw"not implimented"},pop:function(){throw"not implimented"},sort:function(){throw"not implimented"},ksort:function(e){var t,r,n,o=this,s=o.keys();for(void 0==e?s.sort():s.sort(e),t=0;t<s.length;t++)n=s[t],r=o[n],delete o[n],o[n]=r;return o},toObject:function(){var e,t={},r=this;for(e in r)r.hasOwnProperty(e)&&(t[e]=r[e]);return t}},t.prototype=new r,n.prototype={scheme:"",host:"",port:"",path:"",query:"",anchor:"",toString:function(){var e=this,t=e.query+"";return e.scheme+"://"+e.host+e.path+(""!=t?"?"+t:"")+(""!==e.anchor?"#"+e.anchor:"")}},o.prototype=new t,o.prototype.toString=function(){var e,t=this,r=[],n="",o="",i=s.urlEncode;t.ksort();for(e in t)t.hasOwnProperty(e)&&void 0!=e&&void 0!=t[e]&&(o=i(e)+"="+i(t[e]),r.push(o));return r.length>0&&(n=r.join("&")),n},o.prototype.setQueryParams=function(e){var t,r,n,o,i=arguments,a=i.length,u=this,c=s.urlDecode;if(1==a){if("object"==typeof e)for(t in e)e.hasOwnProperty(t)&&(u[t]=c(e[t]));else if("string"==typeof e)for(r=e.split("&"),t=0,n=r.length;n>t;t++)o=r[t].split("="),""!=o[0]&&(u[o[0]]=c(o[1]))}else for(t=0;a>t;t+=2)u[i[t]]=c(i[t+1])};var m="1.0";return s.prototype={realm:"",requestTokenUrl:"",authorizationUrl:"",accessTokenUrl:"",init:function(e){var t="",r={enablePrivilege:e.enablePrivilege||!1,proxyUrl:e.proxyUrl,callbackUrl:e.callbackUrl||"oob",consumerKey:e.consumerKey,consumerSecret:e.consumerSecret,accessTokenKey:e.accessTokenKey||t,accessTokenSecret:e.accessTokenSecret||t,verifier:t,signatureMethod:e.signatureMethod||"HMAC-SHA1"};return this.realm=e.realm||t,this.requestTokenUrl=e.requestTokenUrl||t,this.authorizationUrl=e.authorizationUrl||t,this.accessTokenUrl=e.accessTokenUrl||t,this.getAccessToken=function(){return[r.accessTokenKey,r.accessTokenSecret]},this.getAccessTokenKey=function(){return r.accessTokenKey},this.getAccessTokenSecret=function(){return r.accessTokenSecret},this.setAccessToken=function(e,t){t&&(e=[e,t]),r.accessTokenKey=e[0],r.accessTokenSecret=e[1]},this.getVerifier=function(){return r.verifier},this.setVerifier=function(e){r.verifier=e},this.setCallbackUrl=function(e){r.callbackUrl=e},this.request=function(e){var t,o,f,l,p,d,v,y,g,k,T,w,A,q,C,S,x=[],b={};t=e.method||"GET",o=n(e.url),f=e.data||{},l=e.headers||{},p=e.success||function(){},d=e.failure||function(){},C=function(){var e=!1;for(var t in f)(f[t]instanceof File||"undefined"!=typeof f[t].fileName)&&(e=!0);return e}(),A=!!e.appendQueryString&&e.appendQueryString,r.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead UniversalBrowserWrite"),v=h(),v.onreadystatechange=function(){if(4===v.readyState){var e,t=/^(.*?):\s*(.*?)\r?$/gm,r=l,n={},o="";if(v.getAllResponseHeaders)for(o=v.getAllResponseHeaders();e=t.exec(o);)n[e[1]]=e[2];else if(v.getResponseHeaders){o=v.getResponseHeaders();for(var s=0,i=o.length;i>s;++s)n[o[s][0]]=o[s][1]}var a=!1;"Content-Type"in n&&"text/xml"==n["Content-Type"]&&(a=!0);var u={text:v.responseText,xml:a?v.responseXML:"",requestHeaders:r,responseHeaders:n};v.status>=200&&v.status<=226||304==v.status||0===v.status?p(u):v.status>=400&&0!==v.status&&d(u)}},g={oauth_callback:r.callbackUrl,oauth_consumer_key:r.consumerKey,oauth_token:r.accessTokenKey,oauth_signature_method:r.signatureMethod,oauth_timestamp:u(),oauth_nonce:c(),oauth_verifier:r.verifier,oauth_version:m},k=r.signatureMethod,q=o.query.toObject();for(y in q)b[y]=q[y];if(!("Content-Type"in l&&"application/x-www-form-urlencoded"!=l["Content-Type"]||C))for(y in f)b[y]=f[y];if(S=o.scheme+"://"+o.host+o.path,T=a(t,S,g,b),w=s.signatureMethod[k](r.consumerSecret,r.accessTokenSecret,T),g.oauth_signature=w,this.realm&&(g.realm=this.realm),r.proxyUrl&&(o=n(r.proxyUrl+o.path)),A||"GET"==t)o.query.setQueryParams(f),x=null;else if(C){if(C){x=new FormData;for(y in f)x.append(y,f[y])}}else if("string"==typeof f)x=f,"Content-Type"in l||(l["Content-Type"]="text/plain");else{for(y in f)x.push(s.urlEncode(y)+"="+s.urlEncode(f[y]+""));x=x.sort().join("&"),"Content-Type"in l||(l["Content-Type"]="application/x-www-form-urlencoded")}v.open(t,o+"",!0),v.setRequestHeader("Authorization","OAuth "+i(g)),v.setRequestHeader("X-Requested-With","XMLHttpRequest");for(y in l)v.setRequestHeader(y,l[y]);v.send(x)},this},get:function(e,t,r){this.request({url:e,success:t,failure:r})},post:function(e,t,r,n){this.request({method:"POST",url:e,data:t,success:r,failure:n})},getJSON:function(e,t,r){this.get(e,function(e){t(JSON.parse(e.text))},r)},postJSON:function(e,t,r,n){this.request({method:"POST",url:e,data:JSON.stringify(t),success:function(e){r(JSON.parse(e.text))},failure:n,headers:{"Content-Type":"application/json"}})},parseTokenRequest:function(e,t){switch(t){case"text/xml":var r=e.xml.getElementsByTagName("token"),n=e.xml.getElementsByTagName("secret");u[s.urlDecode(r[0])]=s.urlDecode(n[0]);break;default:for(var o=0,i=e.text.split("&"),a=i.length,u={};a>o;++o){var c=i[o].split("=");u[s.urlDecode(c[0])]=s.urlDecode(c[1])}}return u},fetchRequestToken:function(e,t){var r=this;r.setAccessToken("","");var n=r.authorizationUrl;this.get(this.requestTokenUrl,function(t){var o=r.parseTokenRequest(t,t.responseHeaders["Content-Type"]||void 0);r.setAccessToken([o.oauth_token,o.oauth_token_secret]),e(n+"?"+t.text)},t)},fetchAccessToken:function(e,t){var r=this;this.get(this.accessTokenUrl,function(t){var n=r.parseTokenRequest(t,t.responseHeaders["Content-Type"]||void 0);r.setAccessToken([n.oauth_token,n.oauth_token_secret]),r.setVerifier(""),e(t)},t)}},s.signatureMethod={"HMAC-SHA1":function(t,r,n){var o,i,a=s.urlEncode;return t=a(t),r=a(r||""),o=t+"&"+r,i=k(g.prototype,o,n),e.btoa(i)}},s.urlEncode=function(e){function t(e){var t=e.toString(16).toUpperCase();return t.length<2&&(t=0+t),"%"+t}if(!e)return"";e+="";var r,n,o=/[ \t\r\n!*"'();:@&=+$,\/?%#\[\]<>{}|`^\\\u0080-\uffff]/,s=e.length,i=e.split("");for(r=0;s>r;r++)(n=i[r].match(o))&&(n=n[0].charCodeAt(0),128>n?i[r]=t(n):2048>n?i[r]=t(192+(n>>6))+t(128+(63&n)):65536>n?i[r]=t(224+(n>>12))+t(128+(63&n>>6))+t(128+(63&n)):2097152>n&&(i[r]=t(240+(n>>18))+t(128+(63&n>>12))+t(128+(63&n>>6))+t(128+(63&n))));return i.join("")},s.urlDecode=function(e){return e?e.replace(/%[a-fA-F0-9]{2}/gi,function(e){return String.fromCharCode(parseInt(e.replace("%",""),16))}):""},g.prototype=new g,g.prototype.blocksize=64,g.prototype.hash=function(e){function t(e,t,r,n){switch(e){case 0:return t&r|~t&n;case 1:case 3:return t^r^n;case 2:return t&r|t&n|r&n}return-1}var r,n,o,s,i,a,u,c,h,d,v,g,k,m,T,w,A,q,C,S=[1732584193,4023233417,2562383102,271733878,3285377520],x=[1518500249,1859775393,2400959708,3395469782];for(e.constructor===String&&(e=l(e.encodeUTF8())),o=e.length,s=Math.ceil((o+9)/this.blocksize)*this.blocksize-(o+9),n=Math.floor(o/4294967296),r=Math.floor(o%4294967296),i=[255&8*n>>24,255&8*n>>16,255&8*n>>8,255&8*n,255&8*r>>24,255&8*r>>16,255&8*r>>8,255&8*r],e=e.concat([128],f(s),i),a=Math.ceil(e.length/this.blocksize),u=0;a>u;u++){for(c=e.slice(u*this.blocksize,(u+1)*this.blocksize),h=c.length,d=[],v=0;h>v;v++)d[v>>>2]|=c[v]<<24-8*(v-4*(v>>2));for(g=S[0],k=S[1],m=S[2],T=S[3],w=S[4],A=0;80>A;A++)A>=16&&(d[A]=y(d[A-3]^d[A-8]^d[A-14]^d[A-16],1)),q=Math.floor(A/20),C=y(g,5)+t(q,k,m,T)+w+x[q]+d[A],w=T,T=m,m=y(k,30),k=g,g=C;S[0]+=g,S[1]+=k,S[2]+=m,S[3]+=T,S[4]+=w}return p(S)},s}(exports);var exports=exports||this;!function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.btoa=e.btoa||function(e){for(var r,n,o=0,s=e.length,i="";s>o;o+=3)r=[e.charCodeAt(o),e.charCodeAt(o+1),e.charCodeAt(o+2)],n=[r[0]>>2,(3&r[0])<<4|r[1]>>4,(15&r[1])<<2|r[2]>>6,63&r[2]],isNaN(r[1])&&(n[2]=64),isNaN(r[2])&&(n[3]=64),i+=t.charAt(n[0])+t.charAt(n[1])+t.charAt(n[2])+t.charAt(n[3]);return i}}(exports);