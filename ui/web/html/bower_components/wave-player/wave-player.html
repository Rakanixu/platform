<html><head><link rel="import" href="../paper-material/paper-material.html">
<link rel="import" href="../paper-fab/paper-fab.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-icons/av-icons.html">



</head><body><dom-module id="wave-player">
	<style>
		:host {
			min-width: 480px;
			height: 150px;
			background-color: var(--dark-primary-color);
		}
		paper-icon-button {
			position: absolute;
		}
		.title, .subtitle {
			transition:all .5s ease;
			padding:10px 10px 10px 0;
			left:160px;
			position: absolute;
		}
		.subtitle {
			bottom: 0;
		}
		.controls {
			height:50px;
			width:100%;
			top:0;
			background:var(--accent-color);
			z-index:20
		}
		paper-fab {
			transition:all .5s ease;
			top:-25px;
			z-index:25;
			border-radius:0;
		}
		.albuminfo {
			position: relative;
			transition:all .5s ease;
			top:-156px;
			margin-bottom: -150px;
			z-index:20;
			height:150px;
			width:400px;
			background-color:rgba(0,0,0,.4);
			color:#fff;
			font-family:Roboto,sans-serif;
		}
		.albuminfoActive {
			top:-25;
			height:25px;
			width:100%;
			margin-bottom: -19px;
		}
		.waveContainer {
			top: -31px;
			transition:all .5s ease;
			background-color:var(--dark-primary-color);
			transform:scaleY(1.5)
		} 
		.circleAnimation {
			border-radius:50%;
			overflow:auto;
			-moz-box-shadow:0 2px 5px 0 rgba(0,0,0,.4);
			box-shadow:0 2px 5px 0 rgba(0,0,0,.4)
		}
		.circleAnimation:active {
			-moz-box-shadow:0 8px 17px 0 rgba(0,0,0,.2);
			box-shadow:0 8px 17px 0 rgba(0,0,0,.2)
		}
		.playActive {
			top:0;
			width:100%;
			height:50px
		}
		.waveActive {
			top: 0px;
			transform:scaleY(1)
		}
		.centred, .titleActive {
			transform:scaleY(0);
		}
		.titleActive {
			opacity: 0;
		}
		#playbutton {
			transition:all .5s ease
		}
		.coverart {
			transition:all .5s ease;
			width:150px;
			height:150px
		} 
		.title {
			font-size:24px;
		}
		.coverartActive {
			width:25px;
			height:25px
		}
		.nameActive {
			font-size:19px;
			padding:3px 3px 3px 0;
			left:30px
		}
		.centred {
			top:calc(50% - 20px);
			left:calc(50% - 20px);
			transition:all .3s ease
		} 
		.left,.middle,.right {
			transform:scale(1)
		} 
		.left {
			left:calc(25% - 20px)
		} 
		.right {
			left:calc(75% - 20px)
		}
		.hidden {
			display:none
		}
		
		@media only screen and (max-width: 500px) {
			.albuminfo {
				width:100%;
			}
		}
	</style>
	<template>

		<paper-fab id="playbutton" class="circleAnimation" disabled="" icon="av:play-arrow" on-click="togglePlay"></paper-fab>
		<paper-material class="controls hidden" elevation="2">
			<paper-icon-button class="centred middle" style="color: white" icon="av:pause" on-click="togglePlay"></paper-icon-button>
			<paper-icon-button id="replay" class="centred" style="color: white" icon="av:replay-30" on-click="throwBack"></paper-icon-button>
			<paper-icon-button id="mute" class="centred" style="color: white" icon="av:volume-up" on-click="toggleMute"></paper-icon-button>
		</paper-material>


		<paper-material id="container" class="waveContainer" elevation="0"></paper-material>
		
		<div class="albuminfo">
			<img class="coverart" src="{{coverart}}">
			<span class="title">{{title}}</span>
			<span class="subtitle">{{subtitle}}</span>
		</div>
		
		<script type="text/javascript" src="../wavesurfer.js/dist/wavesurfer.min.js" onload="document.querySelector(&quot;wave-player&quot;).updateWavesurfer();"></script>
	</template>
</dom-module>
<script>!function(){Polymer({is:"wave-player",properties:{src:{type:String,value:"",notify:!0},title:{type:String,value:"",notify:!0},subtitle:{type:String,value:"",notify:!0},coverart:{type:String,value:"art.jpg",notify:!0},wavesurfer:{type:Object},lean:{type:String,value:"left",notify:!0},wavecolor:{type:String,value:"#ffffff",notify:!0},progresscolor:{type:String,value:"#CFD8DC",notify:!0}},ready:function(){"right"===this.lean?(Polymer.dom(this.root).querySelector("paper-fab").style.right="25",Polymer.dom(this.root).querySelector(".controls").style.right="0"):(Polymer.dom(this.root).querySelector("paper-fab").style.left="25",Polymer.dom(this.root).querySelector(".controls").style.left="0"),""===this.name&&Polymer.dom(this.root).querySelector(".albuminfo").classList.add("hidden")},activateAnimation:function(){var e=this,t=Polymer.dom(this.root).querySelector(".waveContainer"),o=Polymer.dom(this.root).querySelector("#playbutton"),r=Polymer.dom(this.root).querySelector(".controls"),i=Polymer.dom(this.root).querySelector("#mute"),s=Polymer.dom(this.root).querySelector("#replay"),l=Polymer.dom(this.root).querySelector(".albuminfo"),a=l.querySelector(".coverart"),c=l.querySelector(".title"),n=l.querySelector(".subtitle");o.setAttribute("icon","av:pause"),o.classList.remove("circleAnimation"),o.classList.add("playActive"),l.classList.add("albuminfoActive"),a.classList.add("coverartActive"),c.classList.add("nameActive"),n.classList.add("titleActive"),"right"===e.lean?Polymer.dom(this.root).querySelector(".playActive").style.right="0":Polymer.dom(this.root).querySelector(".playActive").style.left="0",t.classList.add("waveActive"),setTimeout(function(){r.classList.remove("hidden"),o.classList.add("hidden")},500),setTimeout(function(){i.classList.add("right"),s.classList.add("left")},600)},deactivateAnimation:function(){var e=this,t=Polymer.dom(this.root).querySelector(".waveContainer"),o=Polymer.dom(this.root).querySelector("#playbutton"),r=Polymer.dom(this.root).querySelector(".controls"),i=Polymer.dom(this.root).querySelector("#mute"),s=Polymer.dom(this.root).querySelector("#replay"),l=Polymer.dom(this.root).querySelector(".albuminfo"),a=l.querySelector(".coverart"),c=l.querySelector(".title"),n=l.querySelector(".subtitle");i.classList.remove("right"),s.classList.remove("left"),setTimeout(function(){r.classList.add("hidden"),o.classList.remove("hidden")},100),setTimeout(function(){o.setAttribute("icon","av:play-arrow"),o.classList.add("circleAnimation"),o.classList.remove("playActive"),l.classList.remove("albuminfoActive"),a.classList.remove("coverartActive"),c.classList.remove("nameActive"),n.classList.remove("titleActive"),"right"===e.lean?o.style.right="25":o.style.left="25",t.classList.remove("waveActive")},200)},initWaveSurfer:function(){var e=this;this.wavesurfer.init({container:this.$.container,waveColor:this.wavecolor,progressColor:this.progresscolor,fillParent:!0,height:100}),this.wavesurfer.on("ready",function(){document.querySelector("#playbutton").removeAttribute("disabled")}),this.wavesurfer.on("finish",function(){e.deactivateAnimation()}),this.wavesurfer.load(this.src)},updateWavesurfer:function(){this.wavesurfer=Object.create(WaveSurfer),this.initWaveSurfer()},togglePlay:function(e){this.wavesurfer.playPause();var t=this.$.playbutton.getAttribute("icon");"av:play-arrow"===t?this.activateAnimation():this.deactivateAnimation()},toggleMute:function(e){var t=Polymer.dom(this.root).querySelector("#mute"),o=t.getAttribute("icon");this.wavesurfer.toggleMute(),"av:volume-up"===o?t.setAttribute("icon","av:volume-off"):t.setAttribute("icon","av:volume-up")},throwBack:function(e){this.wavesurfer.skipBackward(30)}})}();</script>
</body></html>